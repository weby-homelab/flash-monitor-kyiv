services:
  # üåê –í–µ–±-—ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Ç–∞ API
  web:
    build: .
    container_name: flash-monitor-web
    restart: unless-stopped
    ports:
      - "5050:5050"
    volumes:
      - ./data:/app/data
    env_file:
      - .env
    environment:
      - DATA_DIR=/app/data
      - SCHEDULE_API_URL=http://host.docker.internal:8889
    extra_hosts:
      - "host.docker.internal:host-gateway"
    healthcheck:
      test: ["CMD", "curl", "-f", "http://localhost:5050/api/status"]
      interval: 30s
      timeout: 10s
      retries: 3

  # ‚öôÔ∏è –§–æ–Ω–æ–≤–∏–π –≤–æ—Ä–∫–µ—Ä (–ú–æ–Ω—ñ—Ç–æ—Ä–∏–Ω–≥ —Ç–∞ –∑–≤—ñ—Ç–∏)
  worker:
    build: .
    container_name: flash-monitor-worker
    restart: unless-stopped
    command: python run_background.py
    volumes:
      - ./data:/app/data
    env_file:
      - .env
    environment:
      - DATA_DIR=/app/data
      - SCHEDULE_API_URL=http://host.docker.internal:8889
    extra_hosts:
      - "host.docker.internal:host-gateway"
